<!DOCTYPE HTML>
<html>
  <head>
    <meta charset="utf-8">
    <title>tic-tac-toe</title>
    <style>
      body {
        background-color: #000;
        color: #fff;
        font-family: Calibri, sans-serif;
        text-align: center;
        margin-top: 40px;
      }
      table {
        margin: 0 auto;
        border-collapse: collapse;
      }
      tr {
        height: 100px;
      }
      td {
        width: 100px;
        border: 2px solid #fff;
        text-align: center;
        font-size: 48px;
        cursor: pointer;
      }
      td:hover {
        background-color: #222;
      }
    </style>
    <script>
      var count = 0; 
      var player = 1;

      function determine(id) {
        var grids = [];
        var isLine = false;
        var currentSelection = document.getElementById(id);		

        if (currentSelection.innerHTML) {
          window.alert("此位置無法選取！");
        } else if (player == 1) {
          currentSelection.innerHTML = '<span style="color:#0ff;">X</span>'; 
          player = 2; 
          count++; 
        } else if (player == 2) {
          currentSelection.innerHTML = '<span style="color:#ff0;">O</span>'; 
          player = 1; 
          count++;
        }
        
        for (var i = 1; i <= 3; i++) {
          grids[i] = [];
          for (var j = 1; j <= 3; j++) {
            grids[i][j] = document.getElementById("grid" + i + j).textContent;
          }				
        }

        for (var i = 1; i <= 3; i++) {
          if ((grids[i][1] != "") && (grids[i][1] == grids[i][2]) && (grids[i][2]== grids[i][3])) {
            isLine = true;
          }
          if ((grids[1][i] != "") && (grids[1][i] == grids[2][i]) && (grids[2][i] == grids[3][i])) {
            isLine = true;
          }				
        }
        
        if (((grids[1][1] != "") && (grids[1][1] == grids[2][2]) && (grids[2][2]== grids[3][3])) || 
            ((grids[3][1] != "") && (grids[3][1] == grids[2][2]) && (grids[2][2]== grids[1][3]))) {
          isLine = true;
        }
        
        if (isLine == true) {			
          if (currentSelection.textContent == "O") {
            setTimeout(() => { 
              window.alert("O 贏了！"); 
              location.reload();
            }, 300);					
          }
          else if (currentSelection.textContent == "X") {
            setTimeout(() => { 
              window.alert("X 贏了！"); 
              location.reload();
            }, 300);		
          }
        } else if (count == 9) {
          setTimeout(() => { 
            window.alert("平手！"); 
            location.reload();
          }, 300);		
        }			
      }
    </script>
  </head>
  <body>
    <h1>井字棋遊戲</h1>
    <table>
      <tr>
        <td id="grid11" onclick="determine(id)"></td>
        <td id="grid12" onclick="determine(id)"></td>
        <td id="grid13" onclick="determine(id)"></td>
      </tr>
      <tr>
        <td id="grid21" onclick="determine(id)"></td>
        <td id="grid22" onclick="determine(id)"></td>
        <td id="grid23" onclick="determine(id)"></td>
      </tr>
      <tr>
        <td id="grid31" onclick="determine(id)"></td>
        <td id="grid32" onclick="determine(id)"></td>
        <td id="grid33" onclick="determine(id)"></td>
      </tr>
    </table>
  </body>
</html>
